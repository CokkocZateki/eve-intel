/*
 (c) 2014, Vladimir Agafonkin
 simpleheat, a tiny JavaScript library for drawing heatmaps with Canvas
 https://github.com/mourner/simpleheat
*/
(function(){"use strict";function e(t){if(!(this instanceof e)){return new e(t)}this._canvas=t=typeof t==="string"?document.getElementById(t):t;this._ctx=t.getContext("2d");this._width=t.width;this._height=t.height;this._max=1;this._data=[]}e.prototype={resize:function(){this._width=canvas.width;this._height=canvas.height},defaultRadius:25,defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},data:function(e){this._data=e;return this},max:function(e){this._max=e;return this},add:function(e){this._data.push(e);return this},clear:function(){this._data=[];return this},radius:function(e,t){t=t||15;var n=this._circle=document.createElement("canvas"),r=n.getContext("2d"),i=this._r=e+t;n.width=n.height=i*2;r.shadowOffsetX=r.shadowOffsetY=200;r.shadowBlur=t;r.shadowColor="black";r.beginPath();r.arc(i-200,i-200,e,0,Math.PI*2,true);r.closePath();r.fill();return this},gradient:function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=n.createLinearGradient(0,0,0,256);t.width=1;t.height=256;for(var i in e){r.addColorStop(i,e[i])}n.fillStyle=r;n.fillRect(0,0,1,256);this._grad=n.getImageData(0,0,1,256).data;return this},draw:function(e){if(!this._circle){this.radius(this.defaultRadius)}if(!this._grad){this.gradient(this.defaultGradient)}var t=this._ctx;t.clearRect(0,0,this._width,this._height);for(var n=0,r=this._data.length,i;n<r;n++){i=this._data[n];t.globalAlpha=Math.max(i[2]/this._max,e||.05);t.drawImage(this._circle,i[0]-this._r,i[1]-this._r)}var s=t.getImageData(0,0,this._width,this._height);this._colorize(s.data,this._grad);t.putImageData(s,0,0);return this},_colorize:function(e,t){for(var n=3,r=e.length,i;n<r;n+=4){i=e[n]*4;if(i){e[n-3]=t[i];e[n-2]=t[i+1];e[n-1]=t[i+2]}}}};window.simpleheat=e})()